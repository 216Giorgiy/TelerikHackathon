define(["azure-client","datasources"],function(n){"use strict";var t=kendo.observable({id:kendo.guid(),name:"",email:"",createdAt:new Date(2013,10,6),recentMatches:0,recentWins:0,topGames:new kendo.data.DataSource({data:[]}),winLoss:[],formattedCreateDate:function(){return kendo.toString(t.createdAt,"MMM d, yyyy")},gotoProfile:function(n){var t=n.currentTarget.attributes.playerId.value.toString();window.app.application.navigate(kendo.format("views/userProfile.html?playerid="+t))},onShow:function(i){var o,s;console.log(i.view.params.playerid);var r=i.view.params.playerid?parseInt(i.view.params.playerid,10):5,u=n.getTable("player"),f=n.getTable("matchwinner"),e=n.getTable("matchloser");f.where({PlayerID:r}).read().done(function(n){e.where({PlayerID:r}).read().done(function(r){t.set("recentWins",n.length);t.set("recentMatches",n.length+r.length);t.set("winLoss",[{name:"Wins",count:n.length},{name:"Losses",count:r.length}]);$(i.view).fadeIn()})});o=n.invokeApi("preferredgamesforplayer",{method:"get",parameters:{playerid:r}}).then(function(n){t.set("topGames",new kendo.data.DataSource({data:JSON.parse(n.response)}))});s=n.invokeApi("profilenotableopponents",{method:"get",parameters:{playerid:r}}).then(function(n){var i=JSON.parse(n.response);t.set("frequentOpp",i[0].Name);t.set("frequentOppId",i[0].PlayerId);t.set("frequentOppEmail",i[0].EmailAddress);t.set("frequentOppWins",i[0].Wins);t.set("frequentOppLosses",i[0].Losses);t.set("lossOpp",i[1].Name);t.set("lossOppId",i[1].PlayerId);t.set("lossOppEmail",i[1].EmailAddress);t.set("lossOppWins",i[1].Wins);t.set("lossOppLosses",i[1].Losses);t.set("winOpp",i[2].Name);t.set("winOppId",i[2].PlayerId);t.set("winOppEmail",i[2].EmailAddress);t.set("winOppWins",i[2].Wins);t.set("winOppLosses",i[2].Losses);t.set("topGames",new kendo.data.DataSource({data:JSON.parse(result.response)}))});u.lookup(r).done(function(n){t.set("name",n.Name);t.set("email",n.EmailAddress);t.set("createdAt",n.CreatedDate)})}});return t});
//# sourceMappingURL=userProfileViewModel.min.js.map